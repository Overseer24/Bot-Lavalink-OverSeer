{"version":3,"sources":["../src/Constants.ts","../src/BetterWs.ts","../src/Intents.ts","../src/DiscordConnector.ts","../src/Shard.ts","../src/ShardManager.ts","../src/Client.ts","../src/index.ts"],"names":["Constants","resolve","EventEmitter","randomBytes","createHash","createInflate","constants","inflateSync","Intents","LocalBucket","OP","PresenceUpdateStatus","SnowTransfer"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\r\n\r\nconst Constants = {\r\n\tGATEWAY_OP_CODES: {\r\n\r\n\r\n\r\n\t\tDISPATCH: 0 as const,\r\n\r\n\r\n\r\n\t\tHEARTBEAT: 1 as const,\r\n\r\n\r\n\r\n\t\tIDENTIFY: 2 as const,\r\n\r\n\r\n\r\n\t\tPRESENCE_UPDATE: 3 as const,\r\n\r\n\r\n\r\n\t\tVOICE_STATE_UPDATE: 4 as const,\r\n\r\n\r\n\r\n\t\tRESUME: 6 as const,\r\n\r\n\r\n\r\n\t\tRECONNECT: 7 as const,\r\n\r\n\r\n\r\n\t\tREQUEST_GUILD_MEMBERS: 8 as const,\r\n\r\n\r\n\r\n\t\tINVALID_SESSION: 9 as const,\r\n\r\n\r\n\r\n\t\tHELLO: 10 as const,\r\n\r\n\r\n\r\n\t\tHEARTBEAT_ACK: 11 as const\r\n\t},\r\n\tGATEWAY_VERSION: 10 as const\r\n};\r\n\r\nexport = Constants;\r\n","\"use strict\";\r\n\r\n\r\n\r\n\r\n\r\nimport { EventEmitter } from \"events\";\r\nimport { randomBytes, createHash } from \"crypto\";\r\nimport { createInflate, inflateSync, constants, type Inflate } from \"zlib\";\r\nimport https = require(\"https\");\r\nimport http = require(\"http\");\r\nimport util = require(\"util\");\r\n\r\nimport type { Socket } from \"net\";\r\n\r\nimport type {\r\n\tBWSEvents,\r\n\tIClientWSOptions\r\n} from \"./Types\";\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction eventSwitch(emitter: EventEmitter, cbs: { [eventName: string]: (...args: any[]) => any }): Promise<void> {\r\n\tconst realListeners = new Map<string, (...args: Array<any>) => void>();\r\n\treturn Promise.race(Object.entries(cbs).map(([event, cb]) => {\r\n\t\treturn new Promise<void>((resolve, reject) => {\r\n\t\t\tconst l = (...args: Array<any>) => (async () => cb(...args))().then(resolve, reject);\r\n\t\t\trealListeners.set(event, l);\r\n\t\t\temitter.once(event, l);\r\n\t\t});\r\n\t})).finally(() => {\r\n\t\tfor (const [event, l] of realListeners.entries()) {\r\n\t\t\temitter.removeListener(event, l);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n\r\n\r\n\r\n\r\nclass BetterWs extends EventEmitter<BWSEvents> {\r\n\r\n\tpublic encoding: \"etf\" | \"json\" | \"other\";\r\n\r\n\tpublic compress: boolean;\r\n\r\n\r\n\tprivate _socket: Socket | null = null;\r\n\r\n\tpublic _internal: {\r\n\r\n\t\tclosePromise: Promise<void> | null;\r\n\r\n\t\tcloseTimer: NodeJS.Timeout | null,\r\n\r\n\t\tzlib: Inflate | null;\r\n\t} = {\r\n\t\t\tclosePromise: null,\r\n\t\t\tcloseTimer: null,\r\n\t\t\tzlib: null\r\n\t\t};\r\n\r\n\tprivate _connecting = false;\r\n\r\n\tprivate _lastCloseCode: number | null = null;\r\n\r\n\tprivate _lastCloseReason: string | null = null;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic constructor(public address: string, public options: Omit<IClientWSOptions, \"encoding\"> & { encoding?: IClientWSOptions[\"encoding\"] | \"other\" }) {\r\n\t\tsuper();\r\n\r\n\t\tthis.encoding = options.encoding ?? \"other\";\r\n\t\tthis.compress = options.compress ?? false;\r\n\t}\r\n\r\n\r\n\r\n\r\n\tpublic get status(): 1 | 2 | 3 | 4 {\r\n\t\tconst internal = this._internal;\r\n\t\tif (this._connecting) return 2;\r\n\t\tif (internal.closePromise) return 3;\r\n\t\tif (!this._socket) return 4;\r\n\t\treturn 1;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic connect(): Promise<void> {\r\n\t\tif (this._socket || this._connecting) return Promise.resolve(void 0);\r\n\t\tthis._connecting = true;\r\n\t\tconst key = randomBytes(16).toString(\"base64\");\r\n\t\tconst url = new URL(this.address);\r\n\t\tconst useHTTPS = (url.protocol === \"https:\" || url.protocol === \"wss:\") || url.port === \"443\";\r\n\t\tconst port = url.port || (useHTTPS ? \"443\" : \"80\");\r\n\t\tconst req = (useHTTPS ? https : http).request({\r\n\t\t\thostname: url.hostname,\r\n\t\t\tpath: `${url.pathname}${url.search}`,\r\n\t\t\tport: port,\r\n\t\t\theaders: {\r\n\t\t\t\t\"Connection\": \"Upgrade\",\r\n\t\t\t\t\"Upgrade\": \"websocket\",\r\n\t\t\t\t\"Sec-WebSocket-Key\": key,\r\n\t\t\t\t\"Sec-WebSocket-Version\": \"13\",\r\n\t\t\t\t...this.options.headers\r\n\t\t\t}\r\n\t\t});\r\n\t\treq.end();\r\n\t\tthis.emit(\"debug\", \"Socket sending request to upgrade\");\r\n\t\treturn eventSwitch(req, {\r\n\t\t\tupgrade: (res: http.IncomingMessage, socket: Socket) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis._onUpgrade(key, res, socket);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\treq.destroy();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: e => {\r\n\t\t\t\tthrow e;\r\n\t\t\t},\r\n\t\t\tresponse: (res: http.ServerResponse) => {\r\n\t\t\t\treq.destroy();\r\n\t\t\t\tif (req.socket && !req.socket.destroyed) req.socket.destroy();\r\n\t\t\t\tthis._internal.closePromise = this._socket = null;\r\n\t\t\t\tthrow new Error(`Expected HTTP 101 Upgrade, but got ${res.statusCode} ${res.statusMessage}`);\r\n\t\t\t}\r\n\t\t}).finally(() => {\r\n\t\t\tthis._connecting = false;\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async close(code: number, reason?: string): Promise<void> {\r\n\t\tthis.emit(\"debug\", `Socket attempting to close`);\r\n\t\tconst internal = this._internal;\r\n\t\tif (internal.closePromise) return internal.closePromise;\r\n\t\tif (!this._socket) return Promise.resolve(void 0);\r\n\t\tlet resolver: ((value: unknown) => void) | undefined;\r\n\t\tconst promise = new Promise(resolve => {\r\n\t\t\tresolver = resolve;\r\n\t\t\tconst from = Buffer.from([code >> 8, code & 255]);\r\n\t\t\tthis._write(reason ? Buffer.concat([from, Buffer.from(reason)]) : from, 8);\r\n\t\t\tthis.emit(\"debug\", \"Socket wrote fin packet\");\r\n\t\t}).then(() => {\r\n\t\t\tinternal.closePromise = null;\r\n\t\t});\r\n\r\n\t\tpromise.resolve = resolver;\r\n\t\tinternal.closePromise = promise;\r\n\t\tif (internal.closeTimer) clearTimeout(internal.closeTimer);\r\n\t\tinternal.closeTimer = setTimeout(() => {\r\n\t\t\tthis.emit(\"debug\", \"Server didn't respond for a full close in time\");\r\n\t\t\tthis._onClose();\r\n\t\t}, 5000);\r\n\t\treturn promise;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic sendMessage(data: any): void {\r\n\t\tif (this.encoding === \"json\") this._write(Buffer.from(JSON.stringify(data)), 1);\r\n\t\telse if (this.encoding === \"etf\") this._write(writeETF(data), 2);\r\n\t\telse if (this.encoding === \"other\") this._write(Buffer.from(data), 2);\r\n\t\tthis.emit(\"ws_send\", data);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _write(packet: Buffer, opcode: number): void {\r\n\t\tconst socket = this._socket;\r\n\t\tif (!socket?.writable) return;\r\n\t\tconst length = packet.length;\r\n\t\tlet frame: Buffer | undefined;\r\n\t\tif (length < 126) {\r\n\t\t\tframe = Buffer.allocUnsafe(6 + length);\r\n\t\t\tframe[1] = 128 + length;\r\n\t\t} else if (length < (1 << 16)) {\r\n\t\t\tframe = Buffer.allocUnsafe(8 + length);\r\n\t\t\tframe[1] = 254;\r\n\t\t\tframe[2] = length >> 8;\r\n\t\t\tframe[3] = length & 255;\r\n\t\t} else {\r\n\t\t\tframe = Buffer.allocUnsafe(14 + length);\r\n\t\t\tframe[1] = 255;\r\n\t\t\tframe.writeBigUInt64BE(BigInt(length), 2);\r\n\t\t}\r\n\t\tframe[0] = 128 + opcode;\r\n\t\tframe.writeUInt32BE(0, frame.length - length - 4);\r\n\t\tframe.set(packet, frame.length - length);\r\n\t\tsocket.write(frame);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _onUpgrade(key: string, res: http.IncomingMessage, socket: Socket): void {\r\n\t\tconst hash = createHash(\"sha1\").update(key + \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\").digest(\"base64\");\r\n\t\tconst accept = res.headers[\"sec-websocket-accept\"];\r\n\t\tif (hash !== accept) {\r\n\t\t\tsocket.end(() => {\r\n\t\t\t\tthis.emit(\"error\", \"Failed websocket-key validation\");\r\n\t\t\t});\r\n\t\t\tthrow new Error(`Invalid Sec-Websocket-Accept | expected: ${hash} | received: ${accept}`);\r\n\t\t}\r\n\t\tsocket.once(\"error\", this._onError.bind(this));\r\n\t\tsocket.once(\"close\", this._onClose.bind(this));\r\n\t\tsocket.on(\"readable\", this._onReadable.bind(this));\r\n\t\tthis._socket = socket;\r\n\t\tif (this.compress) {\r\n\t\t\tconst z = createInflate();\r\n\r\n\t\t\tz._c = z.close; z._h = z._handle; z._hc = z._handle.close; z._v = () => void 0;\r\n\t\t\tthis._internal.zlib = z;\r\n\t\t}\r\n\t\tthis.emit(\"ws_open\");\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _onError(error: Error): void {\r\n\t\tif (!this._socket) return;\r\n\t\tthis.emit(\"error\", util.inspect(error, true, 1, false));\r\n\t\tthis._write(Buffer.allocUnsafe(0), 8);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _onClose(): void {\r\n\t\tif (this._internal.closeTimer) clearTimeout(this._internal.closeTimer);\r\n\t\tthis._internal.closeTimer = null;\r\n\t\tconst socket = this._socket;\r\n\t\tconst internal = this._internal;\r\n\t\tthis.emit(\"debug\", \"Socket _onClose called\");\r\n\t\tif (!socket) return;\r\n\t\tsocket.removeListener(\"data\", this._onReadable);\r\n\t\tsocket.removeListener(\"error\", this._onError);\r\n\t\tthis._socket = null;\r\n\r\n\t\tif (internal.closePromise) {\r\n\r\n\t\t\tinternal.closePromise.resolve(void 0);\r\n\t\t\tthis.emit(\"debug\", \"Socket closePromise resolved\");\r\n\t\t} else this.emit(\"debug\", \"Socket didn't have a closePromise to resolve\");\r\n\r\n\t\tif (internal.zlib) {\r\n\t\t\tinternal.zlib.close();\r\n\t\t\tinternal.zlib = null;\r\n\t\t}\r\n\t\tthis.emit(\"ws_close\", this._lastCloseCode ?? 1006, this._lastCloseReason ?? \"Abnormal Closure\");\r\n\t\tthis._lastCloseCode = null;\r\n\t\tthis._lastCloseReason = null;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _onReadable(): void {\r\n\t\tconst socket = this._socket;\r\n\t\twhile((socket?.readableLength ?? 0) > 1) {\r\n\t\t\tlet length = readRange(socket!, 1, 1) & 127;\r\n\t\t\tlet bytes = 0;\r\n\t\t\tif (length > 125) {\r\n\t\t\t\tbytes = length === 126 ? 2 : 8;\r\n\t\t\t\tif (socket!.readableLength < 2 + bytes) return;\r\n\t\t\t\tlength = readRange(socket!, 2, bytes);\r\n\t\t\t}\r\n\t\t\tconst frame = socket!.read(2 + bytes + length) as Buffer;\r\n\t\t\tif (!frame) return;\r\n\t\t\tconst fin = frame[0] >> 7;\r\n\t\t\tconst opcode = frame[0] & 15;\r\n\t\t\tif (fin !== 1 || opcode === 0) this.emit(\"error\", \"discord actually does send messages with fin=0. if you see this error let me know\");\r\n\t\t\tconst payload = frame.subarray(2 + bytes);\r\n\t\t\tthis._processFrame(opcode, payload);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _processFrame(opcode: number, message: Buffer): void {\r\n\t\tconst internal = this._internal;\r\n\t\tswitch (opcode) {\r\n\t\tcase 1: {\r\n\t\t\tlet packet: any;\r\n\t\t\tif (this.encoding === \"json\") packet = JSON.parse(message.toString());\r\n\t\t\telse if (this.encoding === \"other\") packet = message;\r\n\t\t\tthis.emit(\"ws_receive\", packet);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase 2: {\r\n\t\t\tlet packet;\r\n\t\t\tif (this.compress) {\r\n\t\t\t\tconst z = internal.zlib;\r\n\t\t\t\tlet error = null;\r\n\t\t\t\tlet data = null;\r\n\r\n\t\t\t\tz.close = z._handle.close = z._v;\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tdata = z._processChunk(message, constants.Z_SYNC_FLUSH);\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\terror = e;\r\n\t\t\t\t}\r\n\t\t\t\tconst l = message.length;\r\n\t\t\t\tif (message[l - 4] !== 0 || message[l - 3] !== 0 || message[l - 2] !== 255 || message[l - 1] !== 255) this.emit(\"error\", \"discord actually does send fragmented zlib messages. If you see this error let me know\");\r\n\r\n\t\t\t\tz.close = z._c;\r\n\r\n\t\t\t\tz._handle = z._h;\r\n\r\n\t\t\t\tz._handle.close = z._hc;\r\n\r\n\t\t\t\tz._events.error = void 0;\r\n\r\n\t\t\t\tz._eventCount--;\r\n\t\t\t\tz!.removeAllListeners(\"error\");\r\n\t\t\t\tif (error) {\r\n\t\t\t\t\tthis.emit(\"error\", \"Zlib error processing chunk\");\r\n\t\t\t\t\tthis._write(Buffer.allocUnsafe(0), 8);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!data) {\r\n\t\t\t\t\tthis.emit(\"error\", \"Data from zlib processing was null. If you see this error let me know\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.encoding === \"json\") packet = JSON.parse(String(data));\r\n\t\t\t\telse if (this.encoding === \"etf\") packet = readETF(data, 1);\r\n\t\t\t\telse if (this.encoding === \"other\") packet = data;\r\n\t\t\t} else if (this.encoding === \"json\") packet = JSON.parse(inflateSync(message).toString());\r\n\t\t\telse if (this.encoding === \"etf\") packet = readETF(message, 1);\r\n\t\t\telse if (this.encoding === \"other\") packet = message;\r\n\t\t\tthis.emit(\"ws_receive\", packet);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase 8: {\r\n\t\t\tthis._lastCloseCode = message.length > 1 ? (message[0] << 8) + message[1] : 0;\r\n\t\t\tthis._lastCloseReason = message.length > 2 ? message.subarray(2).toString() : \"\";\r\n\t\t\tthis._write(Buffer.from([this._lastCloseCode >> 8, this._lastCloseCode & 255]), 8);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase 9: {\r\n\t\t\tthis._write(message, 10);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction readRange(socket: Socket, index: number, bytes: number): number {\r\n\tlet cursor = 0;\r\n\tlet read = 0;\r\n\tlet num = 0;\r\n\r\n\r\n\tconst readable = socket._readableState;\r\n\tlet currentBufferIndex = readable.bufferIndex;\r\n\tlet currentBuffer = readable.buffer.head ?? readable.buffer[currentBufferIndex];\r\n\r\n\tdo {\r\n\t\tconst data = currentBuffer.data ?? currentBuffer;\r\n\t\tfor (const element of data) {\r\n\t\t\tif (++cursor > index) {\r\n\t\t\t\tnum *= 256;\r\n\t\t\t\tnum += element;\r\n\t\t\t\tif (++read === bytes) return num;\r\n\t\t\t}\r\n\t\t}\r\n\t} while((currentBuffer = (currentBuffer.next ?? readable.buffer[++currentBufferIndex])));\r\n\tthrow new Error(\"readRange failed?\");\r\n}\r\n\r\nfunction readETF(data: Buffer, start: number): Record<any, any> | null | undefined {\r\n\tlet view: DataView | undefined;\r\n\tlet x = start;\r\n\tconst loop = () => {\r\n\t\tconst type = data[x++];\r\n\t\tswitch(type) {\r\n\t\tcase 70: {\r\n\t\t\tconst float = data.readDoubleBE(x);\r\n\t\t\tx += 8;\r\n\t\t\treturn float;\r\n\t\t}\r\n\t\tcase 97: {\r\n\t\t\treturn data[x++];\r\n\t\t}\r\n\t\tcase 98: {\r\n\t\t\tconst int = data.readInt32BE(x);\r\n\t\t\tx += 4;\r\n\t\t\treturn int;\r\n\t\t}\r\n\t\tcase 100: {\r\n\t\t\tconst length = data.readUInt16BE(x);\r\n\t\t\tlet atom = \"\";\r\n\t\t\tif (length > 30) {\r\n\r\n\t\t\t\tatom = data.latin1Slice(x += 2, x + length);\r\n\t\t\t} else {\r\n\t\t\t\tfor (let i = x += 2; i < x + length; i++) {\r\n\t\t\t\t\tatom += String.fromCharCode(data[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tx += length;\r\n\t\t\tif (!atom) return undefined;\r\n\t\t\tif (atom === \"nil\" || atom === \"null\") return null;\r\n\t\t\tif (atom === \"true\") return true;\r\n\t\t\tif (atom === \"false\") return false;\r\n\t\t\treturn atom;\r\n\t\t}\r\n\t\tcase 108: case 106: {\r\n\t\t\tconst array = [] as Array<any>;\r\n\t\t\tif (type === 108) {\r\n\t\t\t\tconst length = data.readUInt32BE(x);\r\n\t\t\t\tx += 4;\r\n\t\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\t\tarray.push(loop());\r\n\t\t\t\t}\r\n\t\t\t\tx++;\r\n\t\t\t}\r\n\t\t\treturn array;\r\n\t\t}\r\n\t\tcase 107: {\r\n\t\t\tconst array = [] as Array<number>;\r\n\t\t\tconst length = data.readUInt16BE(x);\r\n\t\t\tx += 2;\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tarray.push(data[x++]);\r\n\t\t\t}\r\n\t\t\treturn array;\r\n\t\t}\r\n\t\tcase 109: {\r\n\t\t\tconst length = data.readUInt32BE(x);\r\n\t\t\tlet str = \"\";\r\n\t\t\tif (length > 30) {\r\n\r\n\t\t\t\tstr = data.utf8Slice(x += 4, x + length);\r\n\t\t\t} else {\r\n\t\t\t\tlet i = x += 4;\r\n\t\t\t\tconst l = x + length;\r\n\t\t\t\twhile(i < l) {\r\n\t\t\t\t\tconst byte = data[i++];\r\n\t\t\t\t\tif (byte < 128) str += String.fromCharCode(byte);\r\n\t\t\t\t\telse if (byte < 224) str += String.fromCharCode(((byte & 31) << 6) + (data[i++] & 63));\r\n\t\t\t\t\telse if (byte < 240) str += String.fromCharCode(((byte & 15) << 12) + ((data[i++] & 63) << 6) + (data[i++] & 63));\r\n\t\t\t\t\telse str += String.fromCodePoint(((byte & 7) << 18) + ((data[i++] & 63) << 12) + ((data[i++] & 63) << 6) + (data[i++] & 63));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tx += length;\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\tcase 110: {\r\n\r\n\t\t\tif (!view) view = new DataView(data.buffer, data.offset, data.byteLength);\r\n\t\t\tconst length = data[x++];\r\n\t\t\tconst sign = data[x++];\r\n\t\t\tlet left = length;\r\n\t\t\tlet num = BigInt(0);\r\n\t\t\twhile(left > 0) {\r\n\t\t\t\tif (left >= 8) {\r\n\t\t\t\t\tnum <<= BigInt(64);\r\n\t\t\t\t\tnum += view.getBigUint64(x + (left -= 8), true);\r\n\t\t\t\t} else if (left >= 4) {\r\n\t\t\t\t\tnum <<= BigInt(32);\r\n\r\n\t\t\t\t\tnum += BigInt(view.getUint32(x + (left -= 4)), true);\r\n\t\t\t\t} else if (left >= 2) {\r\n\t\t\t\t\tnum <<= BigInt(16);\r\n\r\n\t\t\t\t\tnum += BigInt(view.getUint16(x + (left -= 2)), true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnum <<= BigInt(8);\r\n\t\t\t\t\tnum += BigInt(data[x]);\r\n\t\t\t\t\tleft--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tx += length;\r\n\t\t\treturn (sign ? -num : num).toString();\r\n\t\t}\r\n\t\tcase 116: {\r\n\t\t\tconst obj = {};\r\n\t\t\tconst length = data.readUInt32BE(x);\r\n\t\t\tx += 4;\r\n\t\t\tfor(let i = 0; i < length; i++) {\r\n\t\t\t\tconst key = loop();\r\n\r\n\t\t\t\tobj[key] = loop();\r\n\t\t\t}\r\n\t\t\treturn obj;\r\n\t\t}\r\n\t\t}\r\n\t\tthrow new Error(`Missing etf type: ${type}`);\r\n\t};\r\n\treturn loop();\r\n}\r\n\r\nfunction writeETF(data: any): Buffer {\r\n\tconst b = Buffer.allocUnsafe(1 << 12);\r\n\tb[0] = 131;\r\n\tlet i = 1;\r\n\tconst loop = (obj: any) => {\r\n\t\tconst type = typeof obj;\r\n\t\tswitch(type) {\r\n\t\tcase \"boolean\": {\r\n\t\t\tb[i++] = 100;\r\n\t\t\tif (obj) {\r\n\t\t\t\tb.writeUInt16BE(4, i);\r\n\r\n\t\t\t\tb.latin1Write(\"true\", i += 2);\r\n\t\t\t\ti += 4;\r\n\t\t\t} else {\r\n\t\t\t\tb.writeUInt16BE(5, i);\r\n\r\n\t\t\t\tb.latin1Write(\"false\", i += 2);\r\n\t\t\t\ti += 5;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase \"string\": {\r\n\t\t\tconst length = Buffer.byteLength(obj);\r\n\t\t\tb[i++] = 109;\r\n\t\t\tb.writeUInt32BE(length, i);\r\n\r\n\t\t\tb.utf8Write(obj, i += 4);\r\n\t\t\ti += length;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase \"number\": {\r\n\t\t\tif (Number.isInteger(obj)) {\r\n\t\t\t\tconst abs = Math.abs(obj);\r\n\t\t\t\tif (abs < 2147483648) {\r\n\t\t\t\t\tb[i++] = 98;\r\n\t\t\t\t\tb.writeInt32BE(obj, i);\r\n\t\t\t\t\ti += 4;\r\n\t\t\t\t} else if (abs < Number.MAX_SAFE_INTEGER) {\r\n\t\t\t\t\tb[i++] = 110;\r\n\t\t\t\t\tb[i++] = 8;\r\n\t\t\t\t\tb[i++] = Number(obj < 0);\r\n\t\t\t\t\tb.writeBigUInt64LE(BigInt(abs), i);\r\n\t\t\t\t\ti += 8;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tb[i++] = 70;\r\n\t\t\t\t\tb.writeDoubleBE(obj, i);\r\n\t\t\t\t\ti += 8;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tb[i++] = 70;\r\n\t\t\t\tb.writeDoubleBE(obj, i);\r\n\t\t\t\ti += 8;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase \"bigint\": {\r\n\t\t\tb[i++] = 110;\r\n\t\t\tb[i++] = 8;\r\n\t\t\tb[i++] = Number(obj < 0);\r\n\t\t\tb.writeBigUInt64LE(obj, i);\r\n\t\t\ti += 8;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase \"object\": {\r\n\t\t\tif (obj === null) {\r\n\t\t\t\tb[i++] = 100;\r\n\t\t\t\tb.writeUInt16BE(3, i);\r\n\r\n\t\t\t\tb.latin1Write(\"nil\", i += 2);\r\n\t\t\t\ti += 3;\r\n\t\t\t} else if (Array.isArray(obj)) {\r\n\t\t\t\tif (obj.length) {\r\n\t\t\t\t\tb[i++] = 108;\r\n\t\t\t\t\tb.writeUInt32BE(obj.length, i);\r\n\t\t\t\t\ti += 4;\r\n\t\t\t\t\tfor (const item of obj) {\r\n\t\t\t\t\t\tloop(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tb[i++] = 106;\r\n\t\t\t} else {\r\n\t\t\t\tconst entries = Object.entries(obj).filter(x => typeof x[1] !== \"undefined\");\r\n\t\t\t\tb[i++] = 116;\r\n\t\t\t\tb.writeUInt32BE(entries.length, i);\r\n\t\t\t\ti += 4;\r\n\t\t\t\tfor(const [key, value] of entries) {\r\n\t\t\t\t\tloop(key);\r\n\t\t\t\t\tloop(value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\t}\r\n\t};\r\n\tloop(data);\r\n\treturn Buffer.from(b.subarray(0, i));\r\n}\r\n\r\n\r\nexport = BetterWs;\r\n","\"use strict\";\r\n\r\nexport type IntentFlags = typeof flags;\r\nexport type IntentResolvable = number | Array<number> | keyof IntentFlags | Array<keyof IntentFlags>;\r\n\r\n\r\n\r\n\r\nexport const flags = {\r\n\tGUILDS: 1 << 0,\r\n\tGUILD_MEMBERS: 1 << 1,\r\n\tGUILD_MODERATION: 1 << 2,\r\n\tGUILD_EMOJIS_AND_STICKERS: 1 << 3,\r\n\tGUILD_INTEGRATIONS: 1 << 4,\r\n\tGUILD_WEBHOOKS: 1 << 5,\r\n\tGUILD_INVITES: 1 << 6,\r\n\tGUILD_VOICE_STATES: 1 << 7,\r\n\tGUILD_PRESENCES: 1 << 8,\r\n\tGUILD_MESSAGES: 1 << 9,\r\n\tGUILD_MESSAGE_REACTIONS: 1 << 10,\r\n\tGUILD_MESSAGE_TYPING: 1 << 11,\r\n\tDIRECT_MESSAGES: 1 << 12,\r\n\tDIRECT_MESSAGE_REACTIONS: 1 << 13,\r\n\tDIRECT_MESSAGE_TYPING: 1 << 14,\r\n\tMESSAGE_CONTENT: 1 << 15,\r\n\tGUILD_SCHEDULED_EVENTS: 1 << 16,\r\n\tAUTO_MODERATION_CONFIGURATION: 1 << 20,\r\n\tAUTO_MODERATION_EXECUTION: 1 << 21,\r\n\tGUILD_MESSAGE_POLLS: 1 << 24,\r\n\tDIRECT_MESSAGE_POLLS: 1 << 25\r\n};\r\n\r\n\r\nexport const privileged = flags.GUILD_MEMBERS | flags.GUILD_PRESENCES | flags.MESSAGE_CONTENT;\r\n\r\nexport const all = Object.values(flags).reduce((acc, p) => acc | p, 0);\r\n\r\nexport const non_privileged = all & ~privileged;\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function resolve(bit: IntentResolvable = 0): number {\r\n\tif (typeof bit === \"number\" && bit >= 0) return bit;\r\n\tif (typeof bit === \"string\" && flags[bit]) return flags[bit] | 0;\r\n\tif (Array.isArray(bit)) return bit.map((p: IntentResolvable) => resolve(p)).reduce((prev, p) => prev | p, 0);\r\n\tthrow new RangeError(\"BITFIELD_INVALID\");\r\n}\r\n\r\nexport default { flags, privileged, all, non_privileged, resolve };\r\n","\"use strict\";\r\n\r\nimport { EventEmitter } from \"events\";\r\nimport BetterWs = require(\"./BetterWs\");\r\nimport { GATEWAY_OP_CODES as OP, GATEWAY_VERSION } from \"./Constants\";\r\nimport Intents = require(\"./Intents\");\r\n\r\nimport { LocalBucket } from \"snowtransfer\";\r\n\r\nimport {\r\n\ttype GatewayReceivePayload,\r\n\ttype GatewayIdentify,\r\n\ttype GatewayPresenceUpdateData,\r\n\ttype GatewayVoiceStateUpdateData,\r\n\ttype GatewayRequestGuildMembersData,\r\n\ttype GatewayRequestGuildMembersDataWithQuery,\r\n\ttype GatewayRequestGuildMembersDataWithUserIds,\r\n\ttype GatewaySendPayload,\r\n\r\n\tPresenceUpdateStatus\r\n} from \"discord-api-types/v10\";\r\n\r\nimport type {\r\n\tConnectorEvents,\r\n\tClientEvents,\r\n\tIClientOptions,\r\n\tIGatewayMessage,\r\n\tIGatewayDispatch\r\n} from \"./Types\";\r\n\r\nconst resumableCodes = [4008, 4005, 4003, 4002, 4001, 4000, 1006, 1001];\r\nconst shouldntAttemptReconnectCodes = [4014, 4013, 4012, 4011, 4010, 4004];\r\nconst disconnectMessages = {\r\n\t4014: \"Disallowed Intents, check your client options and application page.\",\r\n\t4013: \"Invalid Intents data, check your client options.\",\r\n\t4012: \"Invalid API version.\",\r\n\t4011: \"Shard would be on over 2500 guilds. Add more shards.\",\r\n\t4010: \"Invalid sharding data, check your client options.\",\r\n\t4009: \"Session timed out.\",\r\n\t4008: \"You are being rate limited. Wait before sending more packets.\",\r\n\t4007: \"Invalid sequence. Reconnecting and starting a new session.\",\r\n\t4005: \"You sent more than one OP 2 IDENTIFY payload while the websocket was open.\",\r\n\t4004: \"Tried to connect with an invalid token.\",\r\n\t4003: \"You tried to send a packet before sending an OP 2 IDENTIFY or OP 6 RESUME.\",\r\n\t4002: \"You sent an invalid payload.\",\r\n\t4001: \"You sent an invalid opcode or invalid payload for an opcode.\"\r\n};\r\n\r\nconst wsStatusTypes = [\"Whatever 0 is. Report if you see this\", \"connected\", \"connecting\", \"closing\", \"closed\"];\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass DiscordConnector extends EventEmitter<ConnectorEvents> {\r\n\r\n\tpublic options: DiscordConnector[\"client\"][\"options\"];\r\n\r\n\tpublic reconnect: boolean;\r\n\r\n\tpublic betterWs: BetterWs;\r\n\r\n\tpublic heartbeatTimeout: NodeJS.Timeout | null = null;\r\n\r\n\tpublic heartbeatInterval = 0;\r\n\r\n\tpublic _trace: string | null = null;\r\n\r\n\tpublic seq = 0;\r\n\r\n\tpublic status: \"connecting\" | \"identifying\" | \"resuming\" | \"ready\" | \"disconnected\" = \"disconnected\";\r\n\r\n\tpublic sessionId: string | null = null;\r\n\r\n\tpublic lastACKAt = 0;\r\n\r\n\tpublic lastHeartbeatSend = 0;\r\n\r\n\tpublic latency = 0;\r\n\r\n\tpublic identifyAddress: string;\r\n\r\n\tpublic resumeAddress: string | null = null;\r\n\r\n\tpublic reconnecting = false;\r\n\r\n\tpublic wsBucket = new LocalBucket(120, 60000);\r\n\r\n\tpublic presenceBucket = new LocalBucket(5, 60000);\r\n\r\n\r\n\tprivate _closing = false;\r\n\r\n\tprivate _closeCalled = false;\r\n\r\n\tprivate _openToHeartbeatTimeout: NodeJS.Timeout | null = null;\r\n\r\n\tprivate _initialHeartbeatTimeout: NodeJS.Timeout | null = null;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic constructor(public id: number, public client: EventEmitter<ClientEvents> & { options: Omit<IClientOptions, \"snowtransferInstance\"> & { token: string; endpoint?: string; } }) {\r\n\t\tsuper();\r\n\r\n\t\tthis.options = client.options;\r\n\t\tthis.reconnect = this.options.reconnect ?? true;\r\n\t\tthis.identifyAddress = this.options.endpoint!;\r\n\r\n\t\tthis.betterWs = new BetterWs(this.identifyAddress, this.options.ws!);\r\n\r\n\t\tthis.betterWs.on(\"ws_open\", () => {\r\n\t\t\tthis.status = \"connecting\";\r\n\t\t\tthis.emit(\"stateChange\", \"connecting\");\r\n\t\t\tthis.reconnecting = false;\r\n\t\t\tthis._openToHeartbeatTimeout = setTimeout(() => {\r\n\t\t\t\tthis.client.emit(\"debug\", `Shard ${this.id} didn't receive a HELLO after the ws was opened in time`);\r\n\t\t\t\tthis._reconnect(true);\r\n\t\t\t}, 10000);\r\n\t\t});\r\n\t\tthis.betterWs.on(\"ws_receive\", msg => this.messageAction(msg));\r\n\t\tthis.betterWs.on<\"ws_close\">(\"ws_close\", (code, reason) => this.handleWsClose(code, reason));\r\n\t\tthis.betterWs.on(\"debug\", event => this.client.emit(\"debug\", `Shard ${this.id} ${event}`));\r\n\t\tthis.betterWs.on(\"error\", event => this.client.emit(\"error\", event));\r\n\t\tthis.betterWs.on(\"ws_send\", data => this.client.emit(\"rawSend\", data));\r\n\r\n\t\tthis.wsBucket.queue.setBlocked(true);\r\n\t\tthis.presenceBucket.queue.setBlocked(true);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async connect(): Promise<void> {\r\n\t\tthis._closing = false;\r\n\t\tthis._closeCalled = false;\r\n\t\tthis.client.emit(\"debug\", `Shard ${this.id} connecting to gateway`);\r\n\r\n\t\treturn this.betterWs.connect()\r\n\t\t\t.catch(() => {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (!this._closeCalled) this.connect();\r\n\t\t\t\t}, 5000);\r\n\t\t\t});\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async disconnect(): Promise<void> {\r\n\t\tthis._closing = true;\r\n\t\tthis._closeCalled = true;\r\n\t\tthis.wsBucket.queue.setBlocked(true);\r\n\t\tthis.presenceBucket.queue.setBlocked(true);\r\n\t\treturn this.betterWs.close(1000, \"Disconnected by User\");\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate async messageAction(message: GatewayReceivePayload): Promise<void> {\r\n\t\tthis.client.emit(\"rawReceive\", message);\r\n\t\tconst withShardID: IGatewayMessage = Object.assign(message, { shard_id: this.id });\r\n\t\tthis.client.emit(\"event\", withShardID);\r\n\r\n\t\tswitch (withShardID.op) {\r\n\t\tcase OP.DISPATCH:\r\n\t\t\tthis.handleDispatch(withShardID);\r\n\t\t\tbreak;\r\n\r\n\t\tcase OP.HEARTBEAT:\r\n\t\t\tthis.heartbeat();\r\n\t\t\tbreak;\r\n\r\n\t\tcase OP.RECONNECT:\r\n\t\t\tthis.client.emit(\"debug\", `Gateway asked shard ${this.id} to reconnect`);\r\n\t\t\tif (this.reconnect) this._reconnect(true);\r\n\t\t\telse this.disconnect();\r\n\t\t\tbreak;\r\n\r\n\t\tcase OP.INVALID_SESSION:\r\n\t\t\tthis.client.emit(\"debug\", `Shard ${this.id}'s session was invalidated`);\r\n\t\t\tif (withShardID.d && this.sessionId) this.resume();\r\n\t\t\telse {\r\n\t\t\t\tthis.seq = 0;\r\n\t\t\t\tthis.sessionId = \"\";\r\n\t\t\t\tthis.emit(\"queueIdentify\", this.id);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tcase OP.HELLO:\r\n\t\t\tif (this._openToHeartbeatTimeout) clearTimeout(this._openToHeartbeatTimeout);\r\n\t\t\tthis.client.emit(\"debug\", `Shard ${this.id} received HELLO`);\r\n\t\t\tthis.lastACKAt = Date.now();\r\n\t\t\tthis.heartbeatInterval = withShardID.d.heartbeat_interval;\r\n\t\t\tthis._initialHeartbeatTimeout = setTimeout(() => this.heartbeat(), this.heartbeatInterval * Math.random());\r\n\t\t\tthis._trace = (withShardID.d as unknown as { _trace: string })._trace;\r\n\t\t\tthis._onHello();\r\n\t\t\tbreak;\r\n\r\n\t\tcase OP.HEARTBEAT_ACK:\r\n\t\t\tthis.lastACKAt = Date.now();\r\n\t\t\tthis.latency = this.lastACKAt - this.lastHeartbeatSend;\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tvoid 0;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate async _reconnect(resume = false): Promise<void> {\r\n\t\tthis.reconnecting = resume;\r\n\t\tthis.wsBucket.queue.setBlocked(true);\r\n\t\tthis.presenceBucket.queue.setBlocked(true);\r\n\t\tawait this.betterWs.close(resume ? 4000 : 1012, \"reconnecting\");\r\n\t\tif (resume) {\r\n\t\t\tthis.clearHeartBeat();\r\n\t\t\tif (this.resumeAddress) this.betterWs.address = this.resumeAddress;\r\n\t\t\telse this.betterWs.address = this.identifyAddress;\r\n\t\t} else {\r\n\t\t\tthis.reset();\r\n\t\t\tthis.betterWs.address = this.identifyAddress;\r\n\t\t}\r\n\t\tthis.connect();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tprivate reset(): void {\r\n\t\tthis.sessionId = null;\r\n\t\tthis.seq = 0;\r\n\t\tthis.lastACKAt = 0;\r\n\t\tthis._trace = null;\r\n\t\tthis.clearHeartBeat();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tprivate setHeartBeat(): void {\r\n\t\tthis.heartbeatTimeout = setInterval(() => {\r\n\t\t\tif (this.lastACKAt <= Date.now() - (this.heartbeatInterval + 5000)) {\r\n\t\t\t\tthis.client.emit(\"debug\", `Shard ${this.id} has not received a heartbeat ACK in ${this.heartbeatInterval + 5000}ms.`);\r\n\t\t\t\tif (this.reconnect) this._reconnect(true);\r\n\t\t\t\telse this.disconnect();\r\n\t\t\t} else this.heartbeat();\r\n\t\t}, this.heartbeatInterval);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tprivate clearHeartBeat(): void {\r\n\t\tif (this.heartbeatTimeout) clearInterval(this.heartbeatTimeout);\r\n\t\tif (this._initialHeartbeatTimeout) clearTimeout(this._initialHeartbeatTimeout);\r\n\t\tthis.heartbeatTimeout = null;\r\n\t\tthis._initialHeartbeatTimeout = null;\r\n\t\tthis.heartbeatInterval = 0;\r\n\t}\r\n\r\n\r\n\r\n\r\n\tprivate _onHello(): void {\r\n\t\tif (this.sessionId) return void this.resume();\r\n\t\telse this.emit(\"queueIdentify\", this.id);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async identify(): Promise<void> {\r\n\t\tif (this.betterWs.status !== 1) {\r\n\t\t\tthis.client.emit(\"error\", `Shard ${this.id} was attempting to identify when the ws was not open. Was ${wsStatusTypes[this.betterWs.status]}`);\r\n\t\t\treturn this._reconnect(true);\r\n\t\t}\r\n\t\tthis.client.emit(\"debug\", `Shard ${this.id} is identifying`);\r\n\r\n\t\tthis.status = \"identifying\";\r\n\t\tthis.emit(\"stateChange\", \"identifying\");\r\n\r\n\t\tconst data = {\r\n\t\t\top: OP.IDENTIFY,\r\n\t\t\td: {\r\n\t\t\t\ttoken: this.options.token,\r\n\t\t\t\tproperties: {\r\n\t\t\t\t\tos: process.platform,\r\n\t\t\t\t\tbrowser: \"CloudStorm\",\r\n\t\t\t\t\tdevice: \"CloudStorm\"\r\n\t\t\t\t},\r\n\t\t\t\tlarge_threshold: this.options.largeGuildThreshold,\r\n\t\t\t\tshard: [this.id, this.options.totalShards ?? 1],\r\n\t\t\t\tintents: this.options.intents ? Intents.resolve(this.options.intents) : 0\r\n\t\t\t}\r\n\t\t} as GatewayIdentify;\r\n\r\n\t\tif (this.options.initialPresence) data.d.presence = this._checkPresenceData(this.options.initialPresence);\r\n\t\treturn this.betterWs.sendMessage(data);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async resume(): Promise<void> {\r\n\t\tif (this.betterWs.status !== 1) {\r\n\t\t\tthis.client.emit(\"error\", `Shard ${this.id} was attempting to resume when the ws was not open. Was ${wsStatusTypes[this.betterWs.status]}`);\r\n\t\t\treturn this._reconnect(true);\r\n\t\t}\r\n\t\tthis.client.emit(\"debug\", `Shard ${this.id} is resuming`);\r\n\r\n\t\tthis.status = \"resuming\";\r\n\t\tthis.emit(\"stateChange\", \"resuming\");\r\n\r\n\t\treturn this.betterWs.sendMessage({\r\n\t\t\top: OP.RESUME,\r\n\t\t\td: { seq: this.seq, token: this.options.token, session_id: this.sessionId! }\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tprivate heartbeat(): void {\r\n\t\tif (this.betterWs.status !== 1) {\r\n\t\t\tthis.client.emit(\"error\", `Shard ${this.id} was attempting to heartbeat when the ws was not open. Was ${wsStatusTypes[this.betterWs.status]}`);\r\n\t\t\treturn void this._reconnect(true);\r\n\t\t}\r\n\t\tthis.betterWs.sendMessage({ op: OP.HEARTBEAT, d: this.seq === 0 ? null : this.seq });\r\n\t\tthis.lastHeartbeatSend = Date.now();\r\n\t\tif (this._initialHeartbeatTimeout) {\r\n\t\t\tclearTimeout(this._initialHeartbeatTimeout);\r\n\t\t\tthis._initialHeartbeatTimeout = null;\r\n\t\t}\r\n\t\tif (!this.heartbeatTimeout) this.setHeartBeat();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate handleDispatch(message: IGatewayDispatch): void {\r\n\t\tthis.client.emit(\"dispatch\", message);\r\n\r\n\t\tif (message.s) {\r\n\t\t\tif (message.s > this.seq + 1) {\r\n\t\t\t\tthis.client.emit(\"debug\", `Shard ${this.id} invalid sequence: { current: ${this.seq} message: ${message.s} }`);\r\n\t\t\t\tthis.seq = message.s;\r\n\t\t\t\tthis.resume();\r\n\t\t\t}\r\n\t\t\tthis.seq = message.s;\r\n\t\t}\r\n\t\tswitch (message.t) {\r\n\t\tcase \"READY\":\r\n\t\tcase \"RESUMED\":\r\n\t\t\tif (message.t === \"READY\") {\r\n\t\t\t\tif (message.d.resume_gateway_url) this.resumeAddress = `${message.d.resume_gateway_url}?v=${GATEWAY_VERSION}&encoding=${this.options.ws?.encoding === \"etf\" ? \"etf\" : \"json\"}${this.options.ws?.compress ? \"&compress=zlib-stream\" : \"\"}`;\r\n\t\t\t\tthis.sessionId = message.d.session_id;\r\n\t\t\t}\r\n\t\t\tthis.status = \"ready\";\r\n\t\t\tthis.emit(\"stateChange\", \"ready\");\r\n\t\t\tthis._trace = (message.d as unknown as { _trace: string })._trace;\r\n\t\t\tthis.emit(\"ready\", message.t === \"RESUMED\");\r\n\t\t\tthis.wsBucket.queue.setBlocked(false);\r\n\t\t\tthis.presenceBucket.queue.setBlocked(false);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tvoid 0;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate handleWsClose(code: number, reason: string): void {\r\n\t\tlet gracefulClose = false;\r\n\t\tthis.status = \"disconnected\";\r\n\t\tthis.emit(\"stateChange\", \"disconnected\");\r\n\t\tthis.clearHeartBeat();\r\n\t\tthis.wsBucket.queue.setBlocked(true);\r\n\t\tthis.presenceBucket.queue.setBlocked(true);\r\n\r\n\t\tconst isManualClose = code === 1000 && this._closing;\r\n\r\n\t\tconst message = disconnectMessages[code as keyof typeof disconnectMessages];\r\n\t\tconst isRecoverable = resumableCodes.includes(code);\r\n\t\tconst shouldntReconnect = shouldntAttemptReconnectCodes.includes(code) || isManualClose;\r\n\r\n\t\tif (isRecoverable && this.resumeAddress) this.betterWs.address = this.resumeAddress;\r\n\t\telse this.betterWs.address = this.identifyAddress;\r\n\r\n\t\tif (message) this.client.emit(\"error\", message);\r\n\r\n\t\tif (isManualClose || this.reconnecting) gracefulClose = true;\r\n\r\n\t\tthis._closing = false;\r\n\r\n\t\tthis.emit(\"disconnect\", code, reason, gracefulClose);\r\n\r\n\t\tif (!shouldntReconnect && this.reconnect) this.connect();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async presenceUpdate(data: Partial<GatewayPresenceUpdateData>): Promise<void> {\r\n\t\treturn this.sendMessage({ op: OP.PRESENCE_UPDATE, d: this._checkPresenceData(data) });\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async voiceStateUpdate(data: GatewayVoiceStateUpdateData & { self_deaf?: boolean; self_mute?: boolean; }): Promise<void> {\r\n\t\tif (!data) return Promise.resolve();\r\n\t\treturn this.sendMessage({ op: OP.VOICE_STATE_UPDATE, d: this._checkVoiceStateUpdateData(data) });\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async requestGuildMembers(data: GatewayRequestGuildMembersData & { limit?: number; }): Promise<void> {\r\n\t\treturn this.sendMessage({ op: OP.REQUEST_GUILD_MEMBERS, d: this._checkRequestGuildMembersData(data) });\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async sendMessage(data: GatewaySendPayload): Promise<void> {\r\n\t\tconst presence = data.op === OP.PRESENCE_UPDATE;\r\n\t\tconst bypass = this.options.ws!.bypassBuckets;\r\n\t\treturn new Promise<void>(res => {\r\n\t\t\tconst sendMsg = () => {\r\n\t\t\t\tconst fn = () => {\r\n\t\t\t\t\tthis.betterWs.sendMessage(data);\r\n\t\t\t\t\tres(void 0);\r\n\t\t\t\t};\r\n\t\t\t\tif (bypass) fn();\r\n\t\t\t\telse this.wsBucket.enqueue(fn);\r\n\t\t\t};\r\n\t\t\tif (presence && !bypass) this.presenceBucket.enqueue(sendMsg);\r\n\t\t\telse sendMsg();\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _checkPresenceData(data: Parameters<DiscordConnector[\"presenceUpdate\"]>[\"0\"]): GatewayPresenceUpdateData {\r\n\t\tdata.status = data.status ?? PresenceUpdateStatus.Online;\r\n\t\tdata.activities = data.activities && Array.isArray(data.activities) ? data.activities : [];\r\n\r\n\t\tif (data.activities) {\r\n\t\t\tfor (const activity of data.activities) {\r\n\t\t\t\tconst index = data.activities.indexOf(activity);\r\n\t\t\t\tif (activity.type === undefined) activity.type = activity.url ? 1 : 0;\r\n\t\t\t\tif (!activity.name) {\r\n\t\t\t\t\tif (activity.state && activity.type === 4) activity.name = \"Custom Status\";\r\n\t\t\t\t\telse data.activities.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdata.afk = data.afk ?? false;\r\n\t\tdata.since = data.since ?? Date.now();\r\n\t\treturn data as GatewayPresenceUpdateData;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _checkVoiceStateUpdateData(data: Parameters<DiscordConnector[\"voiceStateUpdate\"]>[\"0\"]): GatewayVoiceStateUpdateData {\r\n\t\tdata.channel_id = data.channel_id ?? null;\r\n\t\tdata.self_mute = data.self_mute ?? false;\r\n\t\tdata.self_deaf = data.self_deaf ?? false;\r\n\t\treturn data;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _checkRequestGuildMembersData(data: Parameters<DiscordConnector[\"requestGuildMembers\"]>[\"0\"]): GatewayRequestGuildMembersData {\r\n\t\tconst withQuery = data as GatewayRequestGuildMembersDataWithQuery;\r\n\t\tconst withUserIDs = data as GatewayRequestGuildMembersDataWithUserIds;\r\n\t\tif (!withQuery.query && !withUserIDs.user_ids) withQuery.query = \"\";\r\n\t\tif (withQuery.query && withUserIDs.user_ids) delete (data as { query?: string; }).query;\r\n\t\tdata.limit = data.limit ?? 10;\r\n\t\treturn data;\r\n\t}\r\n}\r\n\r\nexport = DiscordConnector;\r\n","\"use strict\";\r\n\r\nimport { EventEmitter } from \"events\";\r\nimport DC = require(\"./DiscordConnector\");\r\n\r\nimport type {\r\n\tShardEvents,\r\n\tClientEvents,\r\n\tIClientOptions\r\n} from \"./Types\"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass Shard extends EventEmitter<ShardEvents> {\r\n\r\n\tpublic ready = false;\r\n\r\n\tpublic connector: DC;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic constructor(public id: number, public client: EventEmitter<ClientEvents> & { options: Omit<IClientOptions, \"snowtransferInstance\"> & { token: string; endpoint?: string; } }) {\r\n\t\tsuper();\r\n\r\n\t\tthis.connector = new DC(id, client);\r\n\t\tthis.connector.on(\"disconnect\", (...args) => {\r\n\t\t\tthis.ready = false;\r\n\t\t\tthis.emit(\"disconnect\", ...args);\r\n\t\t});\r\n\t\tthis.connector.on(\"ready\", resume => this.emit(\"ready\", resume));\r\n\t\tthis.connector.on(\"queueIdentify\", () => this.emit(\"queueIdentify\", this.id));\r\n\t}\r\n\r\n\r\n\r\n\r\n\tpublic get latency(): number {\r\n\t\treturn this.connector.latency;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic connect(): void {\r\n\t\tthis.connector.connect();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic disconnect(): Promise<void> {\r\n\t\treturn this.connector.disconnect();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic presenceUpdate(data: Parameters<Shard[\"connector\"][\"presenceUpdate\"]>[\"0\"]): Promise<void> {\r\n\t\treturn this.connector.presenceUpdate(data);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic voiceStateUpdate(data: Parameters<Shard[\"connector\"][\"voiceStateUpdate\"]>[\"0\"]): Promise<void> {\r\n\t\treturn this.connector.voiceStateUpdate(data);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic requestGuildMembers(data: Parameters<Shard[\"connector\"][\"requestGuildMembers\"]>[\"0\"]): Promise<void> {\r\n\t\treturn this.connector.requestGuildMembers(data);\r\n\t}\r\n}\r\n\r\nexport = Shard;\r\n","\"use strict\";\r\n\r\nimport type { EventEmitter } from \"events\";\r\n\r\nimport Shard = require(\"./Shard\");\r\nimport { LocalBucket } from \"snowtransfer\";\r\n\r\nimport {\r\n\tIClientOptions,\r\n\tClientEvents\r\n} from \"./Types\";\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ShardManager {\r\n\r\n\tpublic options: ShardManager[\"client\"][\"options\"];\r\n\r\n\tpublic shards: { [id: number]: Shard } = {};\r\n\r\n\tpublic identifyBucket = new LocalBucket(1000, 1000 * 60 * 60 * 24);\r\n\r\n\tpublic concurrencyBucket: LocalBucket | null = null;\r\n\r\n\r\n\r\n\r\n\tpublic constructor(public client: EventEmitter<ClientEvents> & { options: Omit<IClientOptions, \"snowtransferInstance\"> & { token: string; endpoint?: string; } }) {\r\n\t\tthis.options = client.options;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic spawn(): void {\r\n\t\tif (!this.concurrencyBucket) throw new Error(\"Trying to spawn shards without calling Client.connect()\");\r\n\t\tfor (const id of (this.options.shards === \"auto\" ? Array(this.options.totalShards).fill(0).map((_, index) => index) : this.options.shards ?? [0])) {\r\n\t\t\tthis.client.emit(\"debug\", `Spawned shard ${id}`);\r\n\t\t\tthis.shards[id] = new Shard(id, this.client);\r\n\t\t\tthis._addListener(this.shards[id]);\r\n\t\t\tthis.shards[id].connector.connect();\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tpublic disconnect(): void {\r\n\t\tfor (const shardKey in this.shards) {\r\n\t\t\tthis.shards[shardKey].disconnect();\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _addListener(shard: Shard): void {\r\n\t\tshard.on(\"ready\", (resume) => {\r\n\t\t\tshard.ready = true;\r\n\t\t\tthis.client.emit(\"debug\", `Shard ${shard.id} ${resume ? \"has resumed\" : \"is ready\"}`);\r\n\t\t\tthis.client.emit(\"shardReady\", { id: shard.id, ready: !resume });\r\n\t\t\tthis._checkReady();\r\n\t\t});\r\n\t\tshard.on(\"queueIdentify\", (shardId) => {\r\n\t\t\tif (!this.shards[shardId]) return this.client.emit(\"debug\", `Received a queueIdentify event for shard ${shardId} but it does not exist. Was it removed?`);\r\n\t\t\tthis.client.emit(\"debug\", `Shard ${shardId} is ready to identify`);\r\n\t\t\tif (shard.connector.reconnecting) return shard.connector.resume();\r\n\t\t\tthis.concurrencyBucket?.enqueue(() => {\r\n\t\t\t\tthis.identifyBucket.enqueue(() => this.shards[shardId].connector.identify());\r\n\t\t\t});\r\n\t\t});\r\n\t\tshard.on(\"disconnect\", (code, reason, gracefulClose) => {\r\n\t\t\tthis.client.emit(\"debug\", `Websocket of shard ${shard.id} closed with code ${code} and reason: ${reason ?? \"None\"}`);\r\n\t\t\tif (code === 1000 && gracefulClose) return this._checkDisconnect();\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _checkReady(): void {\r\n\t\tfor (const shardId in this.shards) {\r\n\t\t\tif (this.shards[shardId]) {\r\n\t\t\t\tif (!this.shards[shardId].ready) return;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.client.emit(\"ready\");\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _checkDisconnect(): void {\r\n\t\tfor (const shardId in this.shards) {\r\n\t\t\tif (this.shards[shardId]) {\r\n\t\t\t\tif (this.shards[shardId].connector.status !== \"disconnected\") return;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.client.emit(\"disconnected\");\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async presenceUpdate(data: Parameters<Shard[\"presenceUpdate\"]>[\"0\"]): Promise<void> {\r\n\t\tfor (const shardKey in this.shards) {\r\n\t\t\tif (this.shards[shardKey]) {\r\n\t\t\t\tconst shard = this.shards[shardKey];\r\n\t\t\t\tthis.shardPresenceUpdate(shard.id, data);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic shardPresenceUpdate(shardId: number, data: Parameters<Shard[\"presenceUpdate\"]>[\"0\"]): Promise<void> {\r\n\t\treturn new Promise((res, rej) => {\r\n\t\t\tconst shard = this.shards[shardId];\r\n\t\t\tif (!shard) rej(new Error(`Shard ${shardId} does not exist`));\r\n\t\t\tif (!shard.ready) return;\r\n\t\t\tshard.presenceUpdate(data).then(result => res(result)).catch(e => rej(e as Error));\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic voiceStateUpdate(shardId: number, data: Parameters<Shard[\"voiceStateUpdate\"]>[\"0\"]): Promise<void> {\r\n\t\treturn new Promise((res, rej) => {\r\n\t\t\tconst shard = this.shards[shardId];\r\n\t\t\tif (!shard) rej(new Error(`Shard ${shardId} does not exist`));\r\n\t\t\tif (!shard.ready) return;\r\n\t\t\tshard.voiceStateUpdate(data).then(result => res(result)).catch(e => rej(e as Error));\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic requestGuildMembers(shardId: number, data: Parameters<Shard[\"requestGuildMembers\"]>[\"0\"]): Promise<void> {\r\n\t\treturn new Promise((res, rej) => {\r\n\t\t\tconst shard = this.shards[shardId];\r\n\t\t\tif (!shard) rej(new Error(`Shard ${shardId} does not exist`));\r\n\t\t\tif (!shard.ready) return;\r\n\t\t\tshard.requestGuildMembers(data).then(result => res(result)).catch(e => rej(e as Error));\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport = ShardManager;\r\n","\"use strict\";\r\n\r\nimport fs = require(\"fs\");\r\nimport path = require(\"path\");\r\n\r\nconst version = JSON.parse(fs.readFileSync(path.join(__dirname, \"../package.json\"), { encoding: \"utf8\" })).version as string;\r\nimport { EventEmitter } from \"events\";\r\nimport Constants = require(\"./Constants\");\r\nimport { SnowTransfer, LocalBucket } from \"snowtransfer\";\r\nimport ShardManager = require(\"./ShardManager\");\r\nimport type { APIGatewayBotInfo } from \"discord-api-types/v10\";\r\n\r\nimport type {\r\n\tClientEvents,\r\n\tIClientOptions\r\n} from \"./Types\";\r\n\r\n\r\n\r\n\r\n\r\nclass Client extends EventEmitter<ClientEvents> {\r\n\r\n\tpublic token: string;\r\n\r\n\tpublic options: Omit<IClientOptions, \"snowtransferInstance\"> & { token: string; endpoint?: string; };\r\n\r\n\tpublic shardManager: ShardManager;\r\n\r\n\tpublic version = version;\r\n\r\n\tprivate readonly _restClient: SnowTransfer;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic constructor(token: string, options: IClientOptions = {}) {\r\n\t\tsuper();\r\n\t\tif (!token) throw new Error(\"Missing token!\");\r\n\t\tthis.options = {\r\n\t\t\tlargeGuildThreshold: 250,\r\n\t\t\tshards: \"auto\",\r\n\t\t\treconnect: true,\r\n\t\t\tintents: 0,\r\n\t\t\ttoken: \"\",\r\n\t\t\tws: {\r\n\t\t\t\tcompress: true,\r\n\t\t\t\tencoding: \"json\"\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis._restClient = options.snowtransferInstance ? options.snowtransferInstance : new SnowTransfer(token);\r\n\t\tdelete options.snowtransferInstance;\r\n\t\tthis.token = token.startsWith(\"Bot \") ? token.substring(4) : token;\r\n\t\tObject.assign(this.options, options);\r\n\t\tthis.options.token = token;\r\n\t\tthis.shardManager = new ShardManager(this);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async connect(): Promise<void> {\r\n\t\tconst initial = await this.fetchConnectInfo();\r\n\t\tif (this.options.shards === \"auto\") this.options.totalShards = initial;\r\n\t\tthis.shardManager.spawn();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async fetchConnectInfo(): Promise<number> {\r\n\t\tconst gateway = await this.getGatewayBot();\r\n\t\tthis._updateEndpoint(gateway.url);\r\n\t\tconst oldQueueConcurrency = [] as Array<() => unknown>;\r\n\t\tconst oldQueueIdentify = [] as Array<() => unknown>;\r\n\t\tif (this.shardManager.concurrencyBucket?.queue.calls.length) {\r\n\t\t\toldQueueConcurrency.push(...this.shardManager.concurrencyBucket.queue.calls);\r\n\t\t\tthis.shardManager.concurrencyBucket.dropQueue();\r\n\t\t}\r\n\t\tif (this.shardManager.identifyBucket.queue.calls.length) oldQueueIdentify.push(...this.shardManager.identifyBucket.queue.calls);\r\n\t\tthis.shardManager.identifyBucket.dropQueue();\r\n\t\tthis.shardManager.concurrencyBucket = new LocalBucket(gateway.session_start_limit.max_concurrency, 5000);\r\n\t\tthis.shardManager.identifyBucket.remaining = gateway.session_start_limit.remaining;\r\n\t\tthis.shardManager.identifyBucket.reset = gateway.session_start_limit.reset_after;\r\n\t\tfor (const fn of oldQueueConcurrency) {\r\n\t\t\tthis.shardManager.concurrencyBucket.enqueue(fn);\r\n\t\t}\r\n\t\tfor (const fn of oldQueueIdentify) {\r\n\t\t\tthis.shardManager.identifyBucket.enqueue(fn);\r\n\t\t}\r\n\t\treturn gateway.shards;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async getGateway(): Promise<string> {\r\n\t\tconst gatewayData = await this._restClient.bot.getGateway();\r\n\t\treturn gatewayData.url;\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async getGatewayBot(): Promise<APIGatewayBotInfo> {\r\n\t\treturn this._restClient.bot.getGatewayBot();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic disconnect(): void {\r\n\t\treturn this.shardManager.disconnect();\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic async presenceUpdate(data: Parameters<Client[\"shardManager\"][\"presenceUpdate\"]>[\"0\"]): Promise<void> {\r\n\t\treturn this.shardManager.presenceUpdate(data);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic shardPresenceUpdate(shardId: number, data: Parameters<Client[\"shardManager\"][\"shardPresenceUpdate\"]>[\"1\"]): Promise<void> {\r\n\t\treturn this.shardManager.shardPresenceUpdate(shardId, data);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic voiceStateUpdate(shardId: number, data: Parameters<Client[\"shardManager\"][\"voiceStateUpdate\"]>[\"1\"]): Promise<void> {\r\n\t\treturn this.shardManager.voiceStateUpdate(shardId, data);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tpublic requestGuildMembers(shardId: number, data: Parameters<Client[\"shardManager\"][\"requestGuildMembers\"]>[\"1\"]): Promise<void> {\r\n\t\tif (!data.guild_id) throw new Error(\"You need to pass a guild_id\");\r\n\t\treturn this.shardManager.requestGuildMembers(shardId, data);\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tprivate _updateEndpoint(gatewayUrl: string): void {\r\n\t\tthis.options.endpoint = `${gatewayUrl}?v=${Constants.GATEWAY_VERSION}&encoding=${this.options.ws?.encoding === \"etf\" ? \"etf\" : \"json\"}${this.options.ws?.compress ? \"&compress=zlib-stream\" : \"\"}`;\r\n\t}\r\n}\r\n\r\nexport = Client;\r\n","import Client2 = require(\"./Client\");\r\nimport Constants = require(\"./Constants\");\r\nimport Intents = require(\"./Intents\");\r\n\r\nimport Shard2 = require(\"./Shard\");\r\nimport ShardManager2 = require(\"./ShardManager\");\r\n\r\nimport BetterWs2 = require(\"./BetterWs\");\r\nimport DiscordConnector2 = require(\"./DiscordConnector\");\r\n\r\nexport { BetterWs2 as BetterWs, DiscordConnector2 as DiscordConnector, Client2 as Client, Constants, Intents, Shard2 as Shard, ShardManager2 as ShardManager };\r\nexport * from \"./Types\";\r\n"]}